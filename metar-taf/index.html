<html>
<head>
  <script>
    var fetch = function(what) {
      var xhr = new XMLHttpRequest();
      xhr.onload = function() {
          document.getElementById(what).innerHTML = JSON.parse(xhr.responseText).data[0];
      };
      xhr.open('GET', 'https://api.checkwx.com/' + what + '/cyyj');
      xhr.setRequestHeader('X-API-KEY', '01ad05ea5201752f22e2e5d0fe');
      xhr.send(null);
    };
    var info = function() {
      var xhr = new XMLHttpRequest();
      xhr.onload = function() {
        var data = JSON.parse(xhr.responseText).data[0];
        console.log(JSON.stringify(data, null, 4));
        document.getElementById('latitude-value').innerHTML = JSON.stringify(data.latitude);
        document.getElementById('longitude-value').innerHTML = JSON.stringify(data.longitude);

        var sunsetUrl = `https://api.sunrise-sunset.org/json?lat=${data.longitude.decimal}&lng=${data.longitude.decimal}`
        var sunsetXhr = new XMLHttpRequest();
        sunsetXhr.onload = function() {
          var sun = JSON.parse(sunsetXhr.responseText);
          console.log(JSON.stringify(sun, null, 4));
          document.getElementById('sunset').innerHTML = JSON.stringify(sun.results.sunset);
        };
        sunsetXhr.open('GET', sunsetUrl);
        sunsetXhr.send(null);
      };
      xhr.open('GET', 'https://api.checkwx.com/station/cyyj');
      xhr.setRequestHeader('X-API-KEY', '01ad05ea5201752f22e2e5d0fe');
      xhr.send(null);
    };
  </script>
</head>
<body>
  <div id="metar"></div>
  <div id="taf"></div>
  <div id="info">
    <div id="latitude">Latitude:  <label id="latitude-value"></label></div>
    <div id="longitude">Longitude: <label id="longitude-value"></label></div>
    <div id="sunset"></div>
  </div>
  
  <script>
    fetch('metar');
    fetch('taf');
    info();
  </script>
</body>
</html>
